<!DOCTYPE html>
<html class="wide wow-animation" lang="en">
  <head>
    <title>Usuarios</title>
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width height=device-height initial-scale=1.0 maximum-scale=1.0 user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <link rel="icon" href="{{ url_for('static', filename='images/favicon.png') }}" type="image/x-icon">
    <!-- Stylesheets-->
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Work+Sans:300,700,800%7CIBM+Plex+Sans:200,300,400,400i,600,700">

     <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>.ie-panel{display: none;background: #212121;padding: 10px 0;box-shadow: 3px 3px 5px 0 rgba(0,0,0,.3);clear: both;text-align:center;position: relative;z-index: 1;} html.ie-10 .ie-panel, html.lt-ie-10 .ie-panel {display: block;}</style>
  </head>
  <body>
   
   
    
      <header class="section page-header">
        <!-- RD Navbar-->
        <div class="rd-navbar-wrap">
          <nav class="rd-navbar rd-navbar-minimal" data-layout="rd-navbar-fixed" data-sm-layout="rd-navbar-fixed" data-md-layout="rd-navbar-fixed" data-md-device-layout="rd-navbar-fixed" data-lg-layout="rd-navbar-static" data-lg-device-layout="rd-navbar-fixed" data-xl-layout="rd-navbar-static" data-xl-device-layout="rd-navbar-static" data-xxl-layout="rd-navbar-static" data-xxl-device-layout="rd-navbar-static" data-lg-stick-up-offset="46px" data-xl-stick-up-offset="46px" data-xxl-stick-up-offset="46px" data-lg-stick-up="true" data-xl-stick-up="true" data-xxl-stick-up="true">
            <div class="rd-navbar-main-outer">
              <div class="rd-navbar-main">
                <!-- RD Navbar Panel-->
                <div class="rd-navbar-panel">
                  <!-- RD Navbar Toggle-->
              
                </div>
                <div class="rd-navbar-main-element">
           
                    <!-- RD Navbar Nav-->
   
                  </div>
               
                </div>
              </div>
        
      </header>
          <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
      
        <div>
        <ul class="list-x1">
                  <h3>Todos los Usuarios</h3>
          
              <div class="col-lg-10.col-xl-8">
      
                    <table id="tablaDatosUsuarios">
                <thead>
               <tr>
                <th>Usuario</th>
                <th>Nombre</th>
                <th>ID Publisher</th>
                <th>Correo</th>
                <th id="DeleteColumn">Eliminar</th>

            </tr>
         </thead>
         <tbody>

          </tbody>
    </table>
               
                </div>
<script> 
   fetch('http://localhost:5000/user')
                .then(response => response.json())

                .then(data => {
                    document.getElementById('tablaDatosUsuarios').getElementsByTagName('tbody')[0].innerHTML = '';
                  

                    data.forEach(user => {
                        const fecha = new Date(user.date);
                        const fechaFinal = fecha.toLocaleDateString();
                        const row = document.createElement('tr');
                         const deleteCell = document.createElement('td');
    const deleteButton = document.createElement('button');
    deleteButton.textContent = 'Eliminar';
    deleteButton.onclick = () => eliminarUsuario(usuario.correo);
                        row.innerHTML = `
                            <td>${user.name}</td>
                            <td>${user.fullname}</td>
                            <td> ${user.id} </td>
                            <td>${user.correo}</td>
                        `;
                        deleteCell.appendChild(deleteButton);

    row.appendChild(deleteCell);
                        document.getElementById('tablaDatosUsuarios').getElementsByTagName('tbody')[0].appendChild(row);
                    });




   
    


      })

                .catch(error => console.error('Error', error));

   
 </script>
              <script>
function eliminarUsuario(correo) {
    const confirmar = confirm(`¿Estás seguro de eliminar al usuario con correo: ${correo}?`);
    if (confirmar) {
        // Realizar la solicitud DELETE al servidor
        fetch(`http://localhost:3300/eliminar-usuario/${correo}`, {
            method: 'DELETE',
        })
            .then(response => response.json())
            .then(data => {
                console.log(data);
            })
            .catch(error => console.error('Error al eliminar usuario', error));
    }
}
             

    
  
</script>


 
            </ul>
    
            </div>
        

    
    
    <!-- Global Mailform Output-->
    <div class="snackbars" id="form-output-global"></div>
    <!-- Javascript-->
    <script src="js/core.min.js"></script>
    <script src="js/script.js"></script>
    <script src="js/verificarCredenciales.js"></script>
    
  </body>
</html>